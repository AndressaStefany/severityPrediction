#!/bin/bash
gpu_ids="0 1 2"  # Modify this to specify the GPU IDs you want to monitor
output_file="vram_log.txt"

while true; do
    line=""
    for gpu_id in $gpu_ids; do
        memory_used="$(nvidia-smi --query-gpu=memory.used --format=csv,noheader,nounits -i $gpu_id)"
        line+="GPU-$gpu_id: $memory_used MB | "
    done
    line="$(date +'%Y-%m-%d %H:%M:%S') $line"
    echo "${line% |}"  # Remove the trailing pipe and space
    sleep 1
done > "$output_file"
